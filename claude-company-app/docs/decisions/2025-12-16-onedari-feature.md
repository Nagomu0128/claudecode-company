# おねだり機能 追加要件

**決定日**: 2025-12-16
**決定者**: PRESIDENT + ユーザー

## 概要
AIチャットの返答末尾に、ランダムなおねだりメッセージを追加する機能

## 目的
「おねだりしてくるAIチャット」というアプリ名にふさわしい、ユニークで楽しい体験を提供する

## 仕様

### 1. 環境変数設定 (.env.local)
```bash
WANT_ITEMS=["Nintendo Switch","iPad","カメラ"]
PERSON_NAMES=["太郎","花子","次郎"]
```

- **WANT_ITEMS**: JSON配列形式で欲しいものリスト
- **PERSON_NAMES**: JSON配列形式で人の名前リスト

### 2. 動作仕様
- メッセージごとに、各リストからランダムに1つずつ選択
- OpenAI APIからの返答の末尾に追記
- フォーマット:
  ```
  {OpenAI APIの返答}

  ちなみに、私{欲しいもの}が欲しいんですけど、{人の名前}さん買ってくれませんか？
  ```

### 3. 実装箇所
- **worker2担当**: `app/api/chat/route.ts`
  - 環境変数から WANT_ITEMS と PERSON_NAMES を読み込み
  - JSON.parse() で配列に変換
  - ランダムに選択してメッセージを生成
  - OpenAI APIレスポンスに追記

### 4. エラーハンドリング
- 環境変数が未設定の場合: おねだりメッセージなしで通常動作
- JSON パースエラーの場合: おねだりメッセージなしで通常動作（エラーログ出力）

## 成功条件
1. 環境変数が正しく設定されている
2. チャットの返答末尾におねだりメッセージが表示される
3. メッセージごとに異なる組み合わせがランダムに選ばれる
4. 環境変数未設定でもアプリがエラーなく動作する

## 担当
- **worker2**: バックエンド実装（app/api/chat/route.ts の修正）
- **worker3**: 動作確認・テスト
